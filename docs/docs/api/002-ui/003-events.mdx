import {PlatformSelector} from '@site/src/components/PlatformSelector/PlatformSelector';
import {PlatformSection} from '@site/src/components/PlatformSection/PlatformSection';

import EventListenersReactJs from './_002-events/#react.mdx';
import EventListenersJavaScript from './_002-events/#js.mdx';

import RegisterEventReactJs from './_002-events/#react/register.mdx';
import RegisterEventJavaScript from './_002-events/#js/register.mdx';

import RemoveEventReactJs from './_002-events/#react/remove.mdx';
import RemoveEventJavaScript from './_002-events/#js/remove.mdx';

import EventReadyJavaScript from './_002-events/events/#js/ready.mdx';
import EventReadyReactJs from './_002-events/events/#react/ready.mdx';

import EventPreDestroyJavaScript from './_002-events/events/#js/preDestroy.mdx';
import EventPreDestroyReactJs from './_002-events/events/#react/preDestroy.mdx';

import EventMessageSentJavaScript from './_002-events/events/#js/messageSent.mdx';
import EventMessageSentReactJs from './_002-events/events/#react/messageSent.mdx';

import EventMessageReceivedJavaScript from './_002-events/events/#js/messageReceived.mdx';
import EventMessageReceivedReactJs from './_002-events/events/#react/messageReceived.mdx';

import EventErrorJavaScript from './_002-events/events/#js/error.mdx';
import EventErrorReactJs from './_002-events/events/#react/error.mdx';

# Events

`NLUX` emits events when the user interacts with the UI, when server sends messages, or
when errors occur. You can register event callbacks to listen to these events.

<PlatformSelector reactJs={EventListenersReactJs} javascript={EventListenersJavaScript}/>

## Listening to Events

You can register event callbacks to listen to events emitted by `NLUX`.

---

### Adding Event Callbacks

<PlatformSection reactJs={RegisterEventReactJs} javascript={RegisterEventJavaScript}/>

---

### Removing Event Callbacks

<PlatformSection reactJs={RemoveEventReactJs} javascript={RemoveEventJavaScript}/>

---

## Events

Below is a list of events emitted by `NLUX`.

---

### Ready

* Event Name: `ready`

This event is emitted when the AI chat UI component is mounted and ready to use.

* Callback Type:

```ts
type ReadyEventDetails = {
    // Props used to initialize the AiChat component
    aiChatProps: AiChatProps;
};

type ReadyCallback = (readyDetails: ReadyEventDetails) => void;
```

* Example:

<PlatformSelector reactJs={EventReadyReactJs} javascript={EventReadyJavaScript}/>

---

### Pre-Destroy

* Event Name: `preDestroy`

This event is emitted when the AI chat UI component is about to be destroyed.
It allows access to the component's state and props before it is destroyed.

* Callback Type:

```ts
type PreDestroyEventDetails = {
    aiChatProps: AiChatProps;
    conversationHistory: Readonly<ConversationItem[]>;
};

type PreDestroyCallback = (preDestroyDetails: PreDestroyEventDetails) => void;
```

* Example:

<PlatformSelector reactJs={EventPreDestroyReactJs} javascript={EventPreDestroyJavaScript}/>

---

### Message Sent

* Event Name: `messageSent`

This event is emitted when the user sends a message. The event only gets triggered when the
adapter method responsible for sending the message to the backend executes successfully.
For [standard adapters](/api/adapters), this means that the message was successfully sent to
the backend.

* Callback Type:

```ts
type MessageSentCallback = (message: string) => void;
```

* Example:

<PlatformSelector reactJs={EventMessageSentReactJs} javascript={EventMessageSentJavaScript}/>

---

### Message Received

* Event Name: `messageReceived`

This event is emitted when a message is received from the server. The event listener receives the
message as a parameter.

| For [Promise Adapters](/api/adapters/custom-adapters#promise-adapters) ― The event listener receives when the promise
is resolved.<br />
| For [Streaming Adapters](/api/adapters/custom-adapters#streaming-adapters) ― The event listener receives the message
when the streaming is complete and the message is fully received.

Please note that `messageReceived` does not mean that the message has fully rendered on the screen.
`NLUX` renders the messages in a character-by-character animation, so the message may still being
rendered when this event is emitted.

* Callback Type:

```ts
type MessageReceivedCallback = (message: string) => void;
```

* Example:

<PlatformSelector reactJs={EventMessageReceivedReactJs} javascript={EventMessageReceivedJavaScript}/>

---

### Error

* Event Name: `error`

This event is emitted when an exception occurs. The event listener receives the `ErrorEventDetails` object
as a parameter.

* Callback Type:

```typescript
type ErrorEventDetails = {
    errorId: string;
    message: string;
};

type ErrorCallback = (error: ErrorEventDetails) => void;
```

* Example:

<PlatformSelector reactJs={EventErrorReactJs} javascript={EventErrorJavaScript}/>
